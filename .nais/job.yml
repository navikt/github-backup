apiVersion: v1
kind: Secret
metadata:
  labels:
    team: aura
  name: github-backup
  namespace: aura
data:
  GITHUB_TOKEN: "{{ GITHUB_TOKEN }}"
  SSH_PUBLIC_KEY: "{{ SSH_PUBLIC_KEY }}"
  SSH_PRIVATE_KEY: "{{ SSH_PRIVATE_KEY }}"
  REMOTE_HOST: "{{ REMOTE_HOST }}"
  REMOTE_USER: "{{ REMOTE_USER }}"
  REMOTE_PATH: "{{ REMOTE_PATH }}"
---
apiVersion: nais.io/v1
kind: Naisjob
metadata:
  labels:
    team: aura
  name: github-backup
  namespace: aura
spec:
  image: {{ image }}
  schedule: "0 3 * * *"
  backoffLimit: 3
  envFrom:
    - secret: github-backup
